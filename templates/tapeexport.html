{% extends "base.html" %}

{% block title %}
<title>OP-1 Tape Export</title>
{% endblock %}

{% block main %}


<h1>OP-1 Tape Export</h1>

<a href="/" class="btn btn-secondary">Home Page</a>

<div id="device-error-container" class="error-container container" hidden>
    <p id="device-error-message">OP-1 not configured. Please configure your OP-1 in <a href="/utilitysettings" class="btn btn-danger">Utility Settings</a></p>
</div>

<div id="main-content">
<div class="samplepackbox" style="text-align: center; margin-top: 30px;">
    <i data-lucide="construction" style="width: 64px; height: 64px; margin-bottom: 20px;"></i>
    <h3>Coming Soon</h3>
    <p>Export OP-1 tape AIFF files to your Downloads folder for use in your DAW.</p>
</div>
</div>

<script>
    // Check if OP-1 is configured before allowing access
    async function checkDeviceRequirement() {
        try {
            const res = await fetch('/get-config-setting?config_option=OP1_MOUNT_PATH');
            const data = await res.json();
            const isSet = data.config_value && data.config_value !== '';

            if (!isSet) {
                document.getElementById('device-error-container').hidden = false;
                document.getElementById('main-content').hidden = true;
            }
        } catch (error) {
            console.error('Error checking device configuration:', error);
        }
    }
    checkDeviceRequirement();

    document.addEventListener('DOMContentLoaded', () => {
        lucide.createIcons();
    });
</script>
{% endblock %}
